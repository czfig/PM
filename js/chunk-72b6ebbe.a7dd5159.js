(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72b6ebbe"],{"0771":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"background-color":"#ffffff"}},[i("h1",{attrs:{align:"center"}},[e._v("试验有效期到期工器具列表")]),i("el-divider"),i("div",{staticStyle:{width:"80%",margin:"0 auto"}},[i("DataTable",{ref:"period-table",attrs:{opera:!0,url:"/toollifecycle/gettesttools",param:e.param,stripe:!0,filter:!1,topOpera:!0,page:"","page-size":9,height:"calc(100vh - 280px)",opgroup:"",checkbox:!0,tableOperationsWidth:100,tableOperations:[{type:"success",name:"一键申请",action:e.showDialog2}],tableSelections:[{type:"select",value:e.param.days,options:[{label:"30天",value:30},{label:"10天",value:10}],action:e.changeDays},{type:"input",value:e.param.toolname,placeholder:"请输入工器具名称",action:e.changeName}],fields:[{id:"code",name:"工器具ID",show:!0},{id:"name",name:"工具名称",show:!0},{id:"period",name:"试验周期",show:!0},{id:"lasttest_time",name:"上次试验时间",show:!0},{id:"totest_time",name:"本次试验到期时间",show:!0}],operations:[{name:"申请中",type:"success",action:null,show:function(e){return void 0!==e.applId}},{name:"试验申请",type:"primary",action:e.showDialog,show:function(e){return void 0===e.applId}}]},on:{initDataTable:e.initTable,handleSelectionChange:e.getselections}})],1),i("DialogForm",{ref:"period-form",attrs:{title:"试验申请理由填写",fields:[{id:"description",lable:"描述",required:!0,type:"textarea"}]},on:{submit:e.onApply}})],1)},o=[],n=(i("4de4"),i("d3b7"),i("159b"),i("6ae0")),s={data:function(){return{user:this.$storage.getUserInfo(),param:{repository_id:this.$storage.getUserInfo().storage_id,days:30,city:this.$storage.getUserInfo().city,toolname:""},tableSelected:[]}},methods:{initTable:function(e){var t=e.data,i=e.success;i(t.list)},changeDays:function(e){this.param.days=e,this.$refs["period-table"].initList()},changeName:function(e){"end"!==e?this.param.toolname=e:this.$refs["period-table"].initList()},showDialog:function(e){this.$refs["period-form"].show(e)},showDialog2:function(){0!==this.tableSelected.length?this.$refs["period-form"].show():this.$message.error("请先选中记录")},getselections:function(e){this.tableSelected=e.filter((function(e){if(void 0===e.applId)return e}))},onApply:function(e){var t=this,i=[],a={applicantId:this.user.id,repositoryId:this.user.storage_id};void 0!==e.id?i.push(Object.assign(a,e)):this.tableSelected.forEach((function(t){i.push(Object.assign({},a,t,e))})),Object(n["b"])(i).then((function(e){t.$refs["period-table"].initList()}))}},created:function(){}},r=s,l=i("2877"),c=Object(l["a"])(r,a,o,!1,null,"fe237d54",null);t["default"]=c.exports},"6ae0":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return n}));var a=i("9dc1");function o(e){return Object(a["a"])({url:"/toollifecycle/toolTestApplication",method:"post",data:e})}function n(e){return Object(a["a"])({url:"/expconfig/getperiod",method:"post",data:e})}}}]);