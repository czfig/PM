(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29327106"],{2425:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"returnContain"},[i("div",{staticClass:"returnContain-info"},[i("br"),t._m(0),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:t.submitApply}},[t._v("提交申请")])],1)],1),i("div",{staticClass:"tools-contain"},[i("div",{staticClass:"tools-left"},[i("label",[t._v("已借用工器具列表")]),i("DataTable",{ref:"lefttable",attrs:{url:"/ToolReturn/getNoReturn",param:{userid:t.user.id},opgroup:"",expand:"",filter:"",stripe:"",height:"calc(100vh - 320px)",fields:[{id:"name",name:"工器具名称",show:!0,width:"120"},{id:"model",name:"规格型号",show:!0,width:"200"}],expandList:[{id:"code",name:"工器具编号",show:!0}]},on:{initDataTable:t.handleLeft}})],1),i("div",{staticClass:"tools-right"},[i("label",[t._v("已扫描退库待查工器具列表")]),i("DataTable",{ref:"righttable",attrs:{filter:!1,stripe:!0,height:"calc(100vh - 320px)",opgroup:!0,opera:!0,"table-operations-width":200,fields:[{id:"code",name:"编号",show:!0,width:"200"},{id:"name",name:"名称",show:!0,width:"140"},{id:"model",name:"规格型号",show:!0,width:"120"}],operations:[{name:"退库待查信息填写",type:"warning",action:t.handleEdit,show:t.judge_visible},{name:"编辑信息",type:"success",action:t.handleEdit,show:t.judge_visible2}]}})],1)]),i("DialogForm",{ref:"workcheck-form",attrs:{title:"退库待查信息登记",fields:[{id:"code",lable:"编号",limit:{min:2,max:20},required:!0,disabled:!0},{id:"name",lable:"名称",limit:{min:2,max:20},required:!0,disabled:!0},{id:"model",lable:"规格型号",limit:{min:2,max:20},required:!0,disabled:!0},{id:"description",lable:"损坏情况描述",limit:{max:255},type:"textarea",rows:5,required:!0},{id:"imgUrl",lable:"损坏图片",type:"image",limit:1,dataType:"array"}]},on:{addImg:t.addImg,submit:t.handleSubmit}})],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-top":"10px"}},[i("span",[t._v("作业工器具--退库待查登记")])])}],n=i("5530"),o=(i("a4d3"),i("e01a"),i("b0c0"),i("d3b7"),i("a434"),i("159b"),i("a15b"),i("9dc1"));function s(t){return Object(o["a"])({url:"/upload/singlefile",method:"post",data:t})}var d=i("83cd"),c={data:function(){return{user:this.$storage.getUserInfo(),addabnormaldialog:!1,readyedData:[],leftData:[],testData:[]}},methods:{judge_visible:function(t){return void 0===t.description},judge_visible2:function(t){return void 0!==t.description},handleLeft:function(t){for(var e=t.data,i=t.success,r=[],a=function(t){var i=e.list[t],a=!1;r.some((function(t,e){if(t.name==i.name&&t.model==i.model)return a=e,!0})),!1===a?r.push({name:i.name,model:i.model,list:[{code:i.code,tool_id:i.tool_id,record_id:i.record_id}]}):r[a].list.push({code:i.code,tool_id:i.tool_id,record_id:i.record_id})},o=0;o<e.list.length;o++)a(o);this.leftData=r,this.testData=[Object(n["a"])(Object(n["a"])({},r[0].list[0]),{},{name:r[0].name,model:r[0].model})],this.$refs["righttable"].initList(this.testData),i(r)},addImg:function(t){var e=t.event,i=t.success,r=e.file,a=new FormData;a.append("file",r),a.append("uploader",this.user.id),a.append("filename",r.name),s(a).then((function(t){i(t.data.id)}))},handleEdit:function(t){this.$refs["workcheck-form"].show(t)},handleSubmit:function(t){for(var e=0;e<this.testData.length;e++){var i=this.testData[e];i.record_id===t.record_id&&this.testData.splice(e,1,t)}t.applicant_id=this.user.id,t.repository_id=this.user.storage_id,t.rank="member"==this.user.sign?1:2,this.readyedData.push(t),this.$message.success("信息填写成功")},submitApply:function(){var t=this;console.log(this.readyedData),this.readyedData.forEach((function(t){t.imgUrl=t.imgUrl.join(",")})),Object(d["a"])(this.readyedData).then((function(e){t.$message.success("审核发起成功"),t.$refs["lefttable"].initList()}))}}},l=c,u=i("2877"),f=Object(u["a"])(l,r,a,!1,null,"61595796",null);e["default"]=f.exports},5530:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i("b64b"),i("a4d3"),i("4de4"),i("d3b7"),i("e439"),i("159b"),i("dbb4");function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}},"83cd":function(t,e,i){"use strict";i.d(e,"d",(function(){return a})),i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return s}));var r=i("9dc1");function a(t){return Object(r["a"])({url:"/ToolReturn/normalReturn",method:"post",data:t})}function n(t){return Object(r["a"])({url:"/ToolReturn/checkRecords",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/ToolReturn/lostRecords",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/ToolReturn/getUnReturnApproveNum",method:"post",data:t})}},a15b:function(t,e,i){"use strict";var r=i("23e7"),a=i("e330"),n=i("44ad"),o=i("fc6a"),s=i("a640"),d=a([].join),c=n!=Object,l=s("join",",");r({target:"Array",proto:!0,forced:c||!l},{join:function(t){return d(o(this),void 0===t?",":t)}})},dbb4:function(t,e,i){var r=i("23e7"),a=i("83ab"),n=i("56ef"),o=i("fc6a"),s=i("06cf"),d=i("8418");r({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(t){var e,i,r=o(t),a=s.f,c=n(r),l={},u=0;while(c.length>u)i=a(r,e=c[u++]),void 0!==i&&d(l,e,i);return l}})},e439:function(t,e,i){var r=i("23e7"),a=i("d039"),n=i("fc6a"),o=i("06cf").f,s=i("83ab"),d=a((function(){o(1)})),c=!s||d;r({target:"Object",stat:!0,forced:c,sham:!s},{getOwnPropertyDescriptor:function(t,e){return o(n(t),e)}})}}]);