(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29307417"],{"4eab":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("split-pane",{attrs:{"min-percent":20,"default-percent":50,split:"vertical"}},[n("template",{slot:"paneL"},[n("div",{staticStyle:{"border-right":"2px solid rgb(193, 193, 193)"}},[n("role-list",{on:{transportData:t.transportData}})],1)]),n("template",{slot:"paneR"},[n("authority-list",{ref:"authorityList",on:{updateRole:t.updateRole}})],1)],2)],1)},r=[],l=n("19ab"),i=n.n(l),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticStyle:{"min-width":"500px","overflow-x":"auto"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("角色列表")])]),[n("el-table",{attrs:{data:t.tableData,"highlight-current-row":""},on:{"current-change":t.selectRole}},[n("el-table-column",{attrs:{label:"序号","min-width":"5%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),n("el-table-column",{attrs:{prop:"name",label:"角色名称","min-width":"15%",align:"center"}})],1)]],2)},o=[],u=n("c24f"),c={data:function(){return{tableData:[]}},created:function(){var t=this;Object(u["c"])().then((function(e){t.tableData=e.data}))},methods:{selectRole:function(t){this.$emit("transportData",t)}}},d=c,h=(n("8d9b"),n("2877")),f=Object(h["a"])(d,s,o,!1,null,null,null),p=f.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticStyle:{"min-width":"500px","voerflow-x":"auto"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v(t._s(t.title))]),n("el-button",{staticStyle:{float:"right",padding:"3px 3px"},attrs:{type:"success"},on:{click:t.submitAuthority}},[t._v("提交 ")])],1),[n("el-tree",{ref:"authorityTree",staticStyle:{height:"calc(100vh - 200px)",overflow:"scroll"},attrs:{data:t.treedata,props:{label:"name",children:"list"},"show-checkbox":"","node-key":"index"}})]],2)},m=[],v=n("2909"),g=(n("d81d"),n("ac1f"),n("1276"),n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("a15b"),n("159b"),n("99af"),n("f7729")),y={data:function(){return{title:"权限列表",checkedKeys:[],currentRole:"",treedata:g["a"].navMenu,selectedAuthority:[]}},created:function(){this.treedata=this.treedata.map((function(t){if(3===t.level)for(var e=0;e<t.list.length;e++)t.list[e].list=[];return t}))},methods:{onlyTwo:function(t,e){return!(e.index.split("-").length>=3)},submitAuthority:function(){for(var t=[],e=this.$refs.authorityTree.getCheckedNodes().map((function(t){return t.index})),n=0;n<e.length;n++){var a=e[n].split("-");if(1===a.length){var r=this.treedata[e[n]];t.push(e[n]),n+=this.getChildNum(r)}else if(2===a.length){var l=this.treedata[a[0]];3===l.level?(t.push(a[0],e[n]),n+=this.getChildNum(l.list[a[1]])):t.push(a[0],e[n])}}t=Object(v["a"])(new Set(t)),this.$emit("updateRole",t.join(","))},getChildNum:function(t){for(var e=t.list.length||0,n=0;n<t.list.length;n++){var a=t.list[n];a.list&&(e+=this.getChildNum(a))}return e},initSelectedAuthority:function(t){for(var e=this,n=[],a=t.menuIndex.split(","),r=function(t){var r=a[t],i=e.treedata[r],s=[],o=0;i.list&&a[t+1]&&a[t+1].length>2&&i.list.forEach((function(e){s.push(e.index),a[t+1]===e.index?t++:(s.pop(),o=1)})),o?n=n.concat(s):n.push(r),l=t},l=0;l<a.length;l++)r(l);this.$refs.authorityTree.setCheckedKeys(n)}}},x=y,w=Object(h["a"])(x,b,m,!1,null,null,null),R=w.exports,_={components:{splitPane:i.a,roleList:p,authorityList:R},data:function(){return{selectedRole:null}},methods:{transportData:function(t){this.selectedRole=t,this.$refs.authorityList.initSelectedAuthority(t)},updateRole:function(t){var e=this;this.selectedRole.menuIndex=t,Object(u["e"])(this.selectedRole).then((function(t){e.$message.success(t.msg),e.$router.push("/")}))}}},j=_,O=Object(h["a"])(j,a,r,!1,null,null,null);e["default"]=O.exports},5824:function(t,e,n){},"8d9b":function(t,e,n){"use strict";n("5824")},c24f:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return o}));var a=n("9dc1");function r(t){return Object(a["a"])({url:"/userManage/getAllCity",method:"post",data:t})}function l(t){return Object(a["a"])({url:"/userManage/updateUser",method:"post",data:t})}function i(t){return Object(a["a"])({url:"/userManage/addUser",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/role/getAllRole",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/role/updateRole",method:"post",data:t})}}}]);